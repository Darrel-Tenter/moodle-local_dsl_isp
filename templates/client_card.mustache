{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template local_dsl_isp/client_card

    Individual client summary card.

    Context variables required for this template:
    * id - int - Client ID
    * fullname - string - Client full name
    * servicetypelabel - string - Service type label
    * planyeartext - string - Plan year date range text
    * dspcounttext - string - DSP completion count text
    * progresspercent - int - Progress percentage
    * status - string - Status code
    * statuslabel - string - Status label
    * statusclass - string - Bootstrap badge class
    * viewurl - string - View client URL
    * managedspsurl - string - Manage DSPs URL
    * updatedocsurl - string - Update documents URL
    * canmanage - boolean - Whether user can manage

    Example context (json):
    {
        "id": 1,
        "fullname": "John Doe",
        "servicetypelabel": "Residential",
        "planyeartext": "Plan year: Jul 1, 2025 - Jun 30, 2026",
        "dspcounttext": "3 of 5 DSPs completed",
        "progresspercent": 60,
        "status": "inprogress",
        "statuslabel": "In Progress",
        "statusclass": "badge-warning",
        "viewurl": "/local/dsl_isp/client.php?id=1&action=view",
        "managedspsurl": "/local/dsl_isp/manage_dsps.php?clientid=1",
        "updatedocsurl": "/local/dsl_isp/client.php?id=1&action=documents",
        "canmanage": true
    }
}}

<div class="card h-100 local-dsl-isp-client-card" data-clientid="{{id}}">
    <div class="card-header d-flex justify-content-between align-items-start">
        <div>
            <h5 class="card-title mb-1">
                <a href="{{viewurl}}" class="text-dark">{{fullname}}</a>
            </h5>
            <span class="badge badge-light">{{servicetypelabel}}</span>
        </div>
        <span class="badge {{statusclass}}">{{statuslabel}}</span>
    </div>
    <div class="card-body">
        <p class="card-text text-muted small mb-2">
            {{planyeartext}}
        </p>
        
        {{! Progress bar }}
        <div class="mb-3">
            <div class="d-flex justify-content-between mb-1">
                <small>{{dspcounttext}}</small>
                <small>{{progresspercent}}%</small>
            </div>
            <div class="progress" style="height: 8px;">
                <div class="progress-bar {{#iscomplete}}bg-success{{/iscomplete}}{{#isinprogress}}bg-warning{{/isinprogress}}{{#isoverdue}}bg-danger{{/isoverdue}}{{#isnotstarted}}bg-secondary{{/isnotstarted}}" 
                     role="progressbar" 
                     style="width: {{progresspercent}}%;" 
                     aria-valuenow="{{progresspercent}}" 
                     aria-valuemin="0" 
                     aria-valuemax="100">
                </div>
            </div>
        </div>
    </div>
    <div class="card-footer bg-transparent">
        <div class="btn-group btn-group-sm" role="group">
            <a href="{{viewurl}}" class="btn btn-outline-primary">
                {{#str}}viewclient, local_dsl_isp{{/str}}
            </a>
            {{#canmanage}}
            <a href="{{managedspsurl}}" class="btn btn-outline-secondary">
                {{#str}}managedsps, local_dsl_isp{{/str}}
            </a>
            <a href="{{updatedocsurl}}" class="btn btn-outline-secondary">
                {{#str}}updatedocuments, local_dsl_isp{{/str}}
            </a>
            {{/canmanage}}
        </div>
    </div>
</div>
